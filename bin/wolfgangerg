#!/usr/bin/php
<?php
include_once ( realpath( dirname( __FILE__, 2 ) ) . "/includes/common.php");

use Wolfgang\ORM\SchemaManager;
use Wolfgang\Config\Orm;

echo "Building Wolfgang ERG...\n";

try {
	$schema_names = Orm::get('schemas');

	foreach ( $schema_names as $schema_name ) {
		$schema = SchemaManager::getInstance()->get($schema_name);
		$schema->buildEntityRelationshipGraph();
	}
	
	echo "DONE!\n";
} catch (\Exception $e) {
	echo( $e->getMessage() . "\n" );
	echo $e->getTraceAsString();
	exit(1);
} catch (\Error $e) {
	echo( $e->getMessage() . "\n" );	
	echo $e->getTraceAsString();
	exit(1);
}